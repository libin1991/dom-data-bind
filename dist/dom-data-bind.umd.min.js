!function(e,t,n,r,s,i,o,a,l,d,c,u,h,p,f,_,v,y,g,b,m,w,E,k,x){!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.DomDataBind=t():e.DomDataBind=t()}(e,function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var s=t[r]={i:r,l:!1,exports:{}};return e[r].call(s.exports,s,s.exports,n),s.l=!0,s.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||d.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&d.defineProperty(e,Symbol.toStringTag,{value:"Module"}),d.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=d.create(null);if(n.r(r),d.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)n.d(r,s,function(t){return e[t]}.bind(null,s));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return d.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=2)}([function(t,n,r){"use strict";(function(t){r.d(n,"a",function(){return s});const s=void 0!==e?e:void 0!==t?t:"undefined"!=typeof self?self:c("return this;")()}).call(this,r(1))},function(t,n){var r;r=function(){return this}();try{r=r||c("return this")()||(0,eval)("this")}catch(t){"object"==typeof e&&(r=e)}t.exports=r},function(n,s,a){"use strict";a.r(s);const u="[object Object]",h=c.call.bind(d.prototype.toString),f=c.call.bind(d.prototype.hasOwnProperty);var _,y=function e(t,...n){let r,s,i=t||{},o=n.length,a=!1;for("boolean"==typeof t&&(a=t,i=n.shift()||{},o=n.length),r=0;r<o;r++)if(n[r])for(s in n[r])f(n[r],s)&&(a&&h(i[s])===u&&h(n[r][s])===u?i[s]=e(!0,i[s],n[r][s]):i[s]=n[r][s]);return i};"undefined"==typeof WeakMap?function(){var t=d.defineProperty,n=i.now()%1e9,r=_=function(){this.name="__st"+(1e9*p.random()>>>0)+n+++"__"};r.prototype={set:function(e,n){var r=e[this.name];return r&&r[0]===e?r[1]=n:t(e,this.name,{value:[e,n],writable:!0}),this},get:function(e){var t;return(t=e[this.name])&&t[0]===e?t[1]:x},delete:function(e){var t=e[this.name];return!(!t||t[0]!==e)&&(t[0]=t[1]=x,!0)},has:function(e){var t=e[this.name];return!!t&&t[0]===e}},e.WeakMap=r}():_=WeakMap;var g={stash:new _,create:function(){return new _}},b=a(0);const m=c.bind.call.bind(c.bind)(c.call.bind,c.call),w=d.defineProperty,E=d.defineProperties,N=d.keys,D=[],C=l.isArray,$=(m(D.forEach),m(D.indexOf)),A=m(D.splice),S=k.log,T=(k.error,k.warn,"undefined"!=typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"),I=HTMLElement.prototype,B=t;B.head,m(I.appendChild),m(I.insertBefore),m(I.hasAttribute),m(I.setAttribute),m(I.removeAttribute);function M(e,t){w(this,"_",{value:{keys:e.slice(0),values:t?t.slice(0):null,idx:0,total:e.length}})}E(M.prototype,{constructor:{value:M},next:{enumerable:!0,configurable:!0,value(){const e={done:this._.idx===this._.total};if(e.done)return e.value=x,e;const t=this._.idx++;return e.value=this._.keys[t],this._.values&&(e.value=[e.value,this._.values[t]]),e}}}),w(M.prototype,T,{value(){return this}});const P=b.a.Set&&b.a.Set.prototype[T]?b.a.Set:H;var V=P;function H(){}E(H.prototype,{constructor:{value:H,configurable:!0},_:{get(){const e=[];return w(this,"_",{value:e}),e}},add:{value(e){return-1===$(this._,e)&&this._.push(e),this}},has:{value(e){return-1!==$(this._,e)}},size:{get(){return this._.length}},clear:{value(){this._.splice(0)}},delete:{value(e){const t=$(this._,e);return-1!==t&&(this._.splice(t,1),!0)}},values:{value(){return new M(this._)}},entries:{value(){return new M(this._,this._)}},forEach:{value(e,t){this._.forEach(t=>e(t,t,this),t)}},[T]:{value(){return this.values()}}});const O=new P;let W;var K=function(e){"function"==typeof e&&(O.add(e),W||(W=r(R,0)))};function R(){const e=[...O];let t;for(O.clear(),W=null;t=e.shift();)t(),t=null}const j=g.create(),L=["destroy","remove","off"];function F(e){let t,n=[];for(t in e)n.push(t);return n}const G={isDestroyed:!1,init(){},destroy(e){if(j.has(this)){let t=j.get(this);j.delete(this),e?t.forEach(Q):K(()=>t.forEach(Q))}"boolean"==typeof this.isDestroyed&&(this.isDestroyed=!0)},onDestroy(e){(function(e){j.has(e)||j.set(e,[]);return j.get(e)})(this).push(e)},getFactory(){if(this.constructor)return this.constructor}},z={extend:function(...e){let t=class extends(this){};return y(t.prototype,e.reduce(function(e,t){if(t){const n=t.prototype||t;F(n).forEach(function(t){e[t]=n[t]})}return e},{})),t},isInstanceOf:function(e){return!!e&&!F(this.prototype).some(function(t){return void 0===e[t]})},create:function(){return new this(...arguments)},getDestroyCallback:function(e,t){return()=>{e&&d.keys(e).forEach(function(t){e[t]&&(L.some(n=>{if(e[t][n]&&("remove"!==n||!(e[t]instanceof Node)))return e[t][n](),!0}),e[t]=x)}),t&&t.has&&t.has(e)&&t.delete(e)}}};function Q(e){"function"==typeof e&&e()}const U=function(){function e(...t){return this&&this.constructor&&this instanceof this.constructor?this.init(...t):new e(...t)}return e.prototype.constructor=e,e}();y(U.prototype,G),y(U,z);var q=U;let J=/native code/i,X=function(){if("undefined"!=typeof setImediate&&J.test(setImediate.toString()))return setImediate;if("function"==typeof Promise&&J.test(Promise.toString())){let e=Promise.resolve();return function(t){e.then(t).catch(e=>k.error(e))}}let e=[],t=!1;return function(n){e.push(n),t||(t=!0,function n(){r(function(){e.shift()(),e.length?n():t=!1},0)}())}}(),Y=!1;const Z=new Set;let ee,te;const ne=()=>{const e=[...Z];for(Z.clear(),Y=!1,ee=0,te=e.length;ee<te;ee++)e[ee]()};X.queue=(e=>{Z.add(e),Y||(Y=!0,X(ne))});var re=X;const se="___$observable$___",ie={configurable:!0,enumerable:!0},oe=new V,ae="___$watching$___",le="__$watchable$__",de=`__$is${le}`,ce=["pop","push","shift","splice","unshift","sort","reverse"],ue=e=>e&&"[object Object]"===d.prototype.toString.call(e),he=new V;let pe=!1;function fe(e,t,n){e[se]||_e(e),t&&!e[se].props[t]?(ye(e,t),ge(e,t)):t&&e[se].props[t].setupInterceptors&&ge(e,t),t&&n?e[se].props[t].storeCallback(n):t||(be(e,!1),n&&e[se].storeCallback(n));const r=function(e,t){e&&(t.dependents&&(t.dependents.delete(e),Ce(e,t.dependents)),t.watchers.delete(e),Ce(e,t.watchers))}.bind(e,n,t?e[se].props[t]:e[se]);return r.destroy=r,r}function _e(e){e[se]||(w(e,se,{configurable:!0,writable:!0,deep:!1,value:{props:{},dependents:new V,watchers:new V,storeCallback:xe}}),ve(e[se].dependents,!1),ve(e[se].watchers,!0))}function ve(e,t=!1){e.async=t,e.isQueued=!1,e.notify=me}function ye(e,t){return e[se].props[t]||(e[se].props[t]={val:x,dependents:new V,watchers:new V,parent:e[se],storeCallback:xe,setupInterceptors:!0,deep:e[se].deep},ve(e[se].props[t].dependents,!1),ve(e[se].props[t].watchers,!0)),e[se].props[t]}function ge(e,t){const n=d.getOwnPropertyDescriptor(e,t)||ie;n.get||(e[se].props[t].val=e[t],e[se].props[t].deep&&be(e[se].props[t].val)),w(e,t,{configurable:n.configurable||!1,enumerable:n.enumerable||!1,get:()=>(oe.size&&oe.forEach(e[se].props[t].storeCallback,e[se].props[t]),n.get?n.get.call(e):e[se].props[t].val),set(r){const s=e[t];return n.set?r=n.set.call(e,r):e[se].props[t].val=r,e[se].props[t].deep&&be(r),r!==s&&(e[se].props[t].watchers.notify(),e[se].props[t].dependents.notify(),e[se].watchers.notify()),r}}),e[se].props[t].setupInterceptors=!1,n===ie&&e[se].watchers.notify()}function be(e,t=!0,n=!1){return ue(e)||C(e)?(e[se]||(ue(e)?_e(e):C(e)&&$e(e)),n||!e[se].deep?(t&&(e[se].deep=!0),C(e)?function(e,t){for(let n=0,r=e.length;n<r;n++)be(e[n],!0,t)}(e):function(e,t){const n=N(e);for(let r=0,s=n.length;r<s;r++)e[se].props[n[r]]||(ye(e,n[r]),ge(e,n[r])),e[se].props[n[r]].deep&&!t||(e[se].props[n[r]].deep=!0,ue(e[n[r]])&&be(e[n[r]],!0,t))}(e),e):void 0):e}function me(){this.size&&(this.async?this.forEach(we):this.forEach(Ee),function(e){e&&we(e);if(pe||!he.size)return;pe=!0,re(ke)}())}function we(e){he.add(e)}function Ee(e){e()}function ke(){const e=[...he];he.clear(),pe=!1;for(let t=0,n=e.length;t<n;t++)e[t]();e.length=0}function xe(e){e.asDependent&&this.dependents?(De(e,this.dependents),this.dependents.add(e)):(De(e,this.watchers),this.watchers.add(e))}function Ne(e){oe.delete(e)}function De(e,t){e[ae]||(w(e,ae,{configurable:!0,writable:!0,value:{watching:new V}}),w(e,"stopWatchingAll",{configurable:!0,writable:!0,value(){e[ae].watching.forEach(t=>t.delete(e)),e[ae].watching.clear()}})),e[ae].watching.add(t)}function Ce(e,t){e[ae]&&e[ae].watching.delete(t)}function $e(e){if(e[se]||_e(e),e[de])return;const t=e.__proto__;if(!t[le]){const e=d.create(t);ce.forEach(n=>{w(e,n,{configurable:!0,writable:!0,value:function(...e){const r=t[n].call(this,...e);return this[se].dependents.notify(),this[se].watchers.notify(),r}})}),w(e,"size",{configurable:!0,get(){return oe.size&&oe.forEach(this[se].storeCallback,this[se]),this.length}}),w(e,de,{value:!0}),w(t,le,{configurable:!0,writable:!0,value:e})}e.__proto__=t[le]}const Ae=b.a.Map&&b.a.Map.prototype[T]?b.a.Map:Se;function Se(){}E(Se.prototype,{constructor:{value:Se,configurable:!0},_:{get(){return w(this,"_",{value:{keys:[],values:[]}}),this._}},get:{value(e){return this._.values[$(this._.keys,e)]}},set:{value(e,t){return-1===$(this._.keys,e)&&(this._.keys.push(e),this._.values.push(t)),this}},has:{value(e){return-1!==$(this._.keys,e)}},size:{get(){return this._.keys.length}},clear:{value(){A(this._.keys,0),A(this._.values,0)}},delete:{value(e){const t=$(this._.keys,e);return-1!==t&&(A(this._.keys,t,1),A(this._.values,t,1),!0)}},keys:{value(){return new M(this._.keys)}},values:{value(){return new M(this._.values)}},entries:{value(){return new M(this._.keys,this._.values)}},forEach:{value(e,t){this._.keys.forEach((t,n)=>e(this._.values[n],t,this),t)}},[T]:{value(){return this.entries()}}});const Te=t,Ie=c,Be=Element.prototype,Me=l.prototype,Pe=new Ae,Ve=Ie.bind.call.bind(Ie.bind),He="DomDataBind",Oe=g.create(),We=`D-${i.now()}-${p.random().toString(36).replace(/[^a-z0-9]+/g,"")}`,Ke=Ve(Ie.call.bind,Ie.call),Re=e=>"[object Object]"===d.prototype.toString.call(e),je=Ke(Me.forEach),Le=Ke(Me.slice),Fe=Ke(Be.hasAttribute),Ge=Ke(Be.getAttribute),ze=Ke(Be.setAttribute),Qe=Ke(Be.removeAttribute),Ue=Ke(Be.insertBefore),qe=Ke(Be.removeChild),Je=Ve(Te.createComment,Te),Xe=Ve(Te.createTextNode,Te),Ye=Ve(Te.createDocumentFragment,Te),Ze=Ve(k.error,k);function et(e){if(e=e.trim(),Pe.has(e))return Pe.get(e);const t=new Ie("$data",`\nwith ($data) {\n    if ($data) {\n        with ($data) {\n            return ${e};\n        }\n    } \n    else {\n        return ${e};\n    }\n}\n`);return Pe.set(e,t),t}function tt(e){const t=[],n=e.attributes.length;for(let r=0;r<n;r++)t.push(e.attributes.item(r).name);return t}var nt=function(e,t){return l.prototype.slice.call(e.querySelectorAll(t))};var rt=class extends q{static has(){return""}static manages(){return!1}render(e,t,n){let r=Oe.get(e);r||(r={data:null,value:"",isQueued:!1,deferUpd:this.update.bind(this,e),tracker:()=>this.render(e,t,r.data)},Oe.set(e,r)),r.data!==n&&(r.tracker.stopWatchingAll&&r.tracker.stopWatchingAll(),r.data=n),r.isQueued||(r.isQueued=!0,re(r.deferUpd))}update(e){if(e.isDestroyed)return;const t=Oe.get(e);if(t){let n="";!function(e){oe.add(e)}(t.tracker);try{n=this._tokenValueGetter(t.data||{}),e.update&&e.update(n)}catch(e){Ze(e)}Ne(t.tracker),t.isQueued=!1,t.value!==n&&(t.value=n)}}getNodeHandler(e){return this._attr&&8!==e.nodeType&&Qe(e,this._attr),new st(this,e)}};class st extends q{init(e,t){this._d=e,this._n=t}destroy(){const e=Oe.get(this);e&&(e.tracker&&e.tracker.stopWatchingAll&&e.tracker.stopWatchingAll(),e.data&&(e.data=null)),super.destroy(),Oe.delete(this)}render(e){this._d.render(this,this._n,e)}update(e){const t=Oe.get(this);if(t&&t.update)return t.update(e)}}var it=class extends rt{init(e){this._tokenText=e,this._tokenValueGetter=et(e)}render(e,t,n){super.render(e,t,n);const r=Oe.get(e);r.update||(r.update=(e=>{e!==t.nodeValue&&(t.nodeValue=e)}))}getNodeHandler(e){if(8===e.nodeType&&e.nodeValue===We){const n=e;e=e.parentNode.insertBefore(t.createTextNode(""),n),n.parentNode.removeChild(n)}return super.getNodeHandler(e)}};const ot=(()=>{const e=Ye();return e.appendChild(Xe("test")),e.appendChild(Xe("")),1===e.cloneNode(!0).childNodes.length})(),at=(()=>{const e=t.createElement("div"),n=Xe("test");return e.appendChild(n),!e.contains(n)})(),lt=Ke(Text.prototype.splitText),dt=new RegExp("{{(.*?)}}"),ct=new RegExp("{{(.*?)}}","g"),ut=e=>e?e.nodeValue:"",ht=e=>dt.test(ut(e));var pt=class{constructor(e,n=[]){this._template=t.createElement("template"),this._template.innerHTML=e,this._directives=n,this._bindings=ft(this._template.content,n)}cloneWith(e={}){be(e);const n=t.importNode(this._template.content,!0);return n[He]=new Et(n,_t(n,this._bindings,this._directives)),n[He].setData(e),n}};function ft(e,n){const r=new Map,s=new Map,i=new Set;let o;const a=e=>{let n,r,a,l=o;for(;n=e.has(o);)if(r=Ge(o,n),(a=e.manages())&&(l=Je("")),vt(s,l).push(gt(e,n,r)),Qe(o,n),a){i.add(o),o.parentNode.insertBefore(l,o);const e=t.createElement("div");e.appendChild(o),l.data=e.innerHTML}return a};return function(e){return[e].concat(nt(e,"*")).reduce(mt,[]).filter(bt)}(e).forEach(e=>{let t=!1;if(i.size)for(let n of i.values())if(at&&3===e.nodeType?16&n.compareDocumentPosition(e)&&(t=!0):n.contains(e)&&(t=!0),t)break;o=e,t||(1===e.nodeType?n.some(a):3===e.nodeType&&(e=>{if(ht(e)){ct.lastIndex=0;let t=ut(e),n=ct.exec(t);for(;n;)if(t==="{{"+n[1]+"}}")vt(s,e).push(yt(it,n[1])),n=null;else{let t=lt(e,n.index);ot&&wt(e),e=lt(t,n[0].length);const r=t.parentNode.insertBefore(Je(We),t);t.parentNode.removeChild(t),vt(s,r).push(yt(it,n[1])),ct.lastIndex=0,!(n=ct.exec(ut(e)))&&ot&&wt(e)}}})(e))}),o=null,s.forEach((t,n)=>{if(e===n)return void r.set([],t);const s=[];let i=n,o=i.parentNode;for(;i!==e;)s.unshift(s.indexOf.call(o.childNodes,i)),o=(i=i.parentNode).parentNode;r.set(s,t)}),s.clear(),i.clear(),r}function _t(e,t,n){const r=[];return t.forEach((t,s)=>{const i=function(e,t){if(!t.length)return e;return je(t,t=>e=e.childNodes[t]),e}(e,s);if(i)for(let e=0,s=t.length;e<s;e++)r.push(t[e].getNodeHandler(i,n));else Ze(new v("dom-data-bind#render(): Unable to find node!"))}),r}function vt(e,t){return e.has(t)||e.set(t,[]),e.get(t)}function yt(e,t){t=t.trim();let n=Oe.get(e);return n||(n={},Oe.set(e,n)),n[t]||(n[t]=new e(t)),n[t]}function gt(e,t,n){n=n.trim();const r=`${t}-${We}-${n}`;let s=Oe.get(e);return s||(s={},Oe.set(e,s)),s[r]||(s[r]=new e(t,n)),s[r]}function bt(e){return 1!==e.nodeType||1===e.nodeType&&e.attributes.length>0}function mt(e,t){if(e.push(t),t.hasChildNodes())for(t=t.firstChild;t;){const n=t.nextSibling;3===t.nodeType&&t.nodeValue&&dt.test(ut(t))&&e.push(t),ot&&wt(t),t=n}return e}function wt(e){3===e.nodeType&&ot&&!e.nodeValue&&(e.parentNode.insertBefore(Je(""),e),e.parentNode.removeChild(e))}class Et{constructor(e,t){this._frag=e,this._bindings=t}destroy(){if(this._bindings){for(let e=0,t=this._bindings.length;e<t;e++)this._bindings[e].destroy();this._bindings.length=0}}setData(e){for(let t=0,n=this._bindings.length;t<n;t++)this._bindings[t].render(e)}}const kt=new Map;function xt(e,t,n){return kt.has(e)||kt.set(e,new pt(e,n)),kt.get(e).cloneWith(t)}var Nt=xt;const Dt=q.extend({$ele:null,init(e,t){const n=this.getFactory(),r={html:e,data:t,directives:n.directives.slice(0)};Oe.set(this,r),(e=>"string"==typeof e)(e)?(this.$ele=xt(e,t,r.directives),r.bindings=this.$ele._domDataBindNodeHandlers):(this.$ele=e,r.bindings=_t(e,ft(e,r.directives),r.directives),t&&this.setData(t)),this.onDestroy(()=>{je(r.bindings,e=>e.destroy()),delete r.data,delete r.directives,delete r.bindings,n.getDestroyCallback(r,Oe)()})},setData(e){be(e);const t=Oe.get(this).bindings;je(t,t=>t.render(e))}});var Ct=Dt;Dt.directives=[];var $t=function(e,t){return!(!e||!t)&&e.classList.contains(t)};var At=function(e,t){let n=o(t).trim().split(/\s+/).map(e=>e.trim());e&&n.length&&n.forEach(t=>e.classList.add(t))};var St=function(e,t){return e.classList.remove(t)};const Tt="_class";var It=class extends rt{static has(e){return Fe(e,Tt)?Tt:""}init(e,t){this._attr=e,this._tokenValueGetter=et(t||"")}render(e,t,n){super.render(e,t,n);const r=Oe.get(e);r.update||(r.update=(e=>(function(e,t={},n={}){d.keys(t).concat(d.keys(n)).forEach(n=>{t[n]&&!$t(e,n)?At(e,n):!t[n]&&$t(e,n)&&St(e,n)})})(t,e,e!==r.value?r.value:{})))}};const Bt="_style";var Mt=class extends rt{static has(e){return Fe(e,Bt)?Bt:""}init(e,t){this._attr=e,this._tokenValueGetter=et(t||"")}render(e,t,n){super.render(e,t,n);const r=Oe.get(e);if(!r.update){const e=t.style;r.update=(t=>{d.keys(t).forEach(n=>{e[n]!==t[n]&&(e[n]=t[n])})})}}};const Pt="_if";function Vt(e){this.value!==e&&(e&&!this.renderedEle?(this.renderedEle=xt(this.renderTemplate,this.data,this.directives),this.renderedEle._children=Le(this.renderedEle.childNodes,0),Ue(this.insertEle.parentNode,this.renderedEle,this.insertEle)):!e&&this.renderedEle&&this.destroyRenderedEle())}function Ht(){this.renderedEle&&(this.renderedEle._children.forEach(e=>e.parentNode&&e.parentNode.removeChild(e)),this.renderedEle[He].destroy(),this.renderedEle=null)}var Ot=class extends rt{static has(e){return Fe(e,Pt)?Pt:""}static manages(){return!0}init(e,t){this._attr=e,this._tokenValueGetter=et(t||"")}render(e,t,n){super.render(e,t,n);const r=Oe.get(e);r.update||(r.renderedEle=null,r.insertEle=e._placeholderEle,r.directives=e._directives,r.destroyRenderedEle=Ht,r.renderTemplate=e._n.data,r.update=Vt,e.onDestroy(()=>r.destroyRenderedEle()))}getNodeHandler(e,t){const n=super.getNodeHandler(e);return n._placeholderEle=Je(""),n._directives=t,Ue(e.parentNode,n._placeholderEle,e),qe(e.parentNode,e),n}};const Wt="_show",Kt="none";var Rt=class extends rt{static has(e){return Fe(e,Wt)?Wt:""}init(e,t){this._attr=e,this._tokenValueGetter=et(t||"")}render(e,t,n){super.render(e,t,n);const r=Oe.get(e);if(!r.update){const e=t.style,n=t.display||"";r.update=(t=>{t?e.display=n:e.display!==Kt&&(e.display=Kt)})}}};const jt=/^_attr\.(.*)/;var Lt=class extends rt{static get _matches(){return jt}static get _isProp(){return!1}static has(e){let t="";return tt(e).some(e=>this._matches.test(e)&&(t=e)),t}init(e,t){this._attr=e,this._tokenValueGetter=et(t||""),this._htmlAttr=new RegExp(this.constructor._matches).exec(e)[1]}render(e,t,n){super.render(e,t,n);let r=Oe.get(e);r.update||(r.update=(e=>{this.constructor._isProp?e!==r.value&&(t[this._htmlAttr]=e):e&&r.value!==e?ze(t,this._htmlAttr,e):r.value&&!e&&Qe(t,this._htmlAttr)}))}};const Ft=/^_prop\.(.*)/;var Gt=class extends Lt{static get _matches(){return Ft}static _isProp(){return!0}};var zt=function(e,t,n,r){let s=t.split(/\s+/),i={};return s.forEach(t=>{e.addEventListener(t,n,r),i[t]={remove:()=>e.removeEventListener(t,n,r)}}),d.create({listeners:i,remove:function(){s.forEach(e=>i[e].remove())}})};const Qt=new RegExp(`^${(e=>o(e).replace(/[-[\]/{}()*+?.\\^$|]/g,"\\$&"))("_on.")}(.*)`);var Ut=class extends rt{static has(e){let t="";return tt(e).some(e=>Qt.test(e)&&(t=e)),t}init(e,t){this._attr=e,this._eventName=new RegExp(Qt).exec(e)[1],this._tokenValueGetter=et(t||"")}handleEvent(e,t){const n=Oe.get(e);let r;n.data.$ev=t;try{r=this._tokenValueGetter(n.data)}catch(e){return void Ze(e)}if(delete n.data.$ev,"function"==typeof r)return r.call(e._n,t);r&&"function"===r.handleEvent&&r.handleEvent.call(r,t)}render(e,t,n){let r=Oe.get(e);r||(r={data:{$data:{}},tracker:()=>this.render(e,t,r.data)},Oe.set(e,r)),n&&(n.$data?r.data=n:r.data.$data=n)}getNodeHandler(e){const t=super.getNodeHandler(e),n=zt(e,this._eventName,this.handleEvent.bind(this,t));return t.onDestroy(()=>n.remove()),t}};function qt(e,t){e[se]||$e(e),t&&e[se].storeCallback(t);const n=()=>e[se].watchers.delete(t);return n.destroy=n,n}const Jt="_each",Xt="_key",Yt=()=>{},Zt=e=>l.isArray(e)&&!e.length||Re(e)&&!d.keys(e).length;function en(){for(let e=0,t=this._children.length;e<t;e++)this._children[e].parentNode&&this._children[e].parentNode.removeChild(this._children[e]);this._loop.rowKey&&this._state.bindersByKey.delete(this._loop.rowKey),this._state=null,this[He].destroy()}var tn=class extends rt{static has(e){return Fe(e,Jt)?Jt:""}static manages(){return!0}init(e,t){const[n,r]=function(e){let t=/\(?(.+?)\)?\W?(?:of|in)\W(.*)/.exec(e);return t?((t=t.slice(1))[0]=t[0].split(/,/).map(e=>o(e).trim()),t):[]}((t||"").trim());this._attr=e,this._iteratorArgs=n,this._tokenValueGetter=et(r||"")}render(e,t,n){super.render(e,t,n);const r=Oe.get(e);r.update||(r.binders=[],r.bindersByKey=new Ae,r.listIterator=(()=>this.iterateOverList(e,r.value)),r.isFirstRender=!0,r.usesKey=!1,r.getKey=Yt,r.update=(t=>{t!==r.value&&(r.value&&(r.value=null,r.listIterator.stopWatchingAll&&r.listIterator.stopWatchingAll()),t?(Ne(r.tracker),r.value=t,be(t),l.isArray(t)?qt(t,r.listIterator):Re(t)&&fe(t,null,r.listIterator),Zt(t)&&r.binders?this.destroyChildBinders(r.binders,e):this.iterateOverList(e,t)):this.destroyChildBinders(r.binders,e))}),e.onDestroy(()=>{r.listIterator.stopWatchingAll&&r.listIterator.stopWatchingAll(),r.bindersByKey.clear(),this.destroyChildBinders(r.binders,e)}))}destroyChildBinders(e,t){if(e&&e.length)if(e=e.splice(0),t._isSoleChild){const n=t._placeholderEle.parentNode;n.textContent="",n.appendChild(t._placeholderEle),r(()=>{je(e,e=>e._destroy())})}else je(e,e=>e._destroy())}getDataForIteration(e,t){return this._iteratorArgs.reduce((t,n)=>(t[n]=e.shift(),t),t||{})}iterateOverList(e,t){const n=Oe.get(e),r=[],s=Ye();let i,o=l.isArray(t);if(o)o=!0,i=t;else{if(!Re(t))return;i=d.keys(t)}for(let a=0,l=i.length;a<l;a++){let l={$data:n.data.$data||n.data};o?this.getDataForIteration([i[a],a],l):this.getDataForIteration([t[i[a]],i[a],a],l);const d=this.getRowBinder(e,l);d._loop.pos=a,r.push(d),s.appendChild(d)}s.hasChildNodes()&&Ue(e._placeholderEle.parentNode,s,e._placeholderEle),je(n.binders.splice(0,n.binders.length,...r),e=>{-1===r.indexOf(e)&&e._destroy()}),n.binders.length&&this.positionChildren(e._placeholderEle.parentNode,e._placeholderEle,n.binders)}getRowBinder(e,t){const n=Oe.get(e);let r,s=null,i=n.getKey(t);return i&&(r=n.bindersByKey.get(i)),r?(delete t.$data,r[He].setData(t),s=r):(r=xt(e._n.data,t,e._directives),n.isFirstRender&&(n.isFirstRender=!1,1===r.childNodes.length&&1===r.firstChild.nodeType&&Fe(r.firstChild,Xt)&&(n.usesKey=!0,n.getKey=et(Ge(r.firstChild,Xt)),i=n.getKey(t))),n.usesKey&&Qe(r.firstChild,Xt),r._children=Le(r.childNodes,0),r._destroy=en,r._state=n,r._loop={rowEle:r,rowKey:i,pos:-1},i&&n.bindersByKey.set(i,r),s=r)}positionChildren(e,t,n){je(n,(r,s)=>{r._loop.pos!==s&&(Ue(e,r._loop.rowEle,n[s+1]?n[s+1]._loop.rowEle:t),r._loop.pos=s)})}getNodeHandler(e,t){const n=super.getNodeHandler(e);return n._directives=t,n._placeholderEle=Je(""),n._isSoleChild=function(e){return l.prototype.every.call(e.parentNode.childNodes,t=>t===e||3===t.nodeType&&!t.textContent.trim())}(e),Ue(e.parentNode,n._placeholderEle,e),qe(e.parentNode,e),n}};const nn="_html";var rn=class extends rt{static has(e){return Fe(e,nn)?nn:""}init(e,t){this._attr=e,this._tokenValueGetter=et(t||"")}render(e,t,n){super.render(e,t,n);const r=Oe.get(e);r.update||(r.update=(e=>{e!==r.value&&(t.innerHTML=e)}))}};a.d(s,"DomDataBindAll",function(){return on}),a.d(s,"allDirectives",function(){return sn}),a.d(s,"DomDataBind",function(){return Ct}),a.d(s,"render",function(){return Nt}),a.d(s,"Directive",function(){return rt}),a.d(s,"EachDirective",function(){return tn}),a.d(s,"IfDirective",function(){return Ot}),a.d(s,"ClassDirective",function(){return It}),a.d(s,"StyleDirective",function(){return Mt}),a.d(s,"ShowDirective",function(){return Rt}),a.d(s,"AttrDirective",function(){return Lt}),a.d(s,"PropDirective",function(){return Gt}),a.d(s,"OnDirective",function(){return Ut}),a.d(s,"HtmlDirective",function(){return rn});const sn=[tn,Ot,It,Mt,Rt,Lt,Gt,Ut,rn],on=Ct.extend();on.directives=sn;s.default=on}])})}(window,document,location,setTimeout,setInterval,Date,String,Number,Array,Object,Function,atob,btoa,Math,JSON,TypeError,Error,encodeURIComponent,decodeURIComponent,requestAnimationFrame,CustomEvent,clearInterval,clearTimeout,console);
//# sourceMappingURL=dom-data-bind.umd.min.js.map